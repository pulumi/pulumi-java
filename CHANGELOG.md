CHANGELOG
=========

## 0.5.2 (2022-07-20)

### Bug Fixes

- [codegen] [#757](https://github.com/pulumi/pulumi-java/pull/757):
  Fixes a regression introduced in 0.5.1 where

      pulumi-java-gen --build gradle

  stopped automatically generating "com.pulumi:pulumi" references in
  the `build.gradle` file, making the generated project fail to
  compile.

## 0.5.1 (2022-07-19)

### Bug Fixes

- [codegen] [#390](https://github.com/pulumi/pulumi-java/issues/390)
  fixes code generation for output types with large (200+) number of
  parameters hitting the JVM limits. Previously these types would
  generate compiling code but throw exceptions at runtime when in use.

  Packages generated with this version of codegen will need to depend
  on `com.pulumi:pulumi` (Java SDK) versions `0.5.0` or higher, so
  that user programs get the upgraded Java SDK that can understand the
  new class annotation scheme and continue working without changes.

- [codegen] [#739](https://github.com/pulumi/pulumi-java/issues/739)
  fixes ambiguity in the "packages" option by adding a new
  "dependencies" option in Java extensions to Package Schema. With
  this change, both package name overrides and desired Maven
  dependencies in the generated build files can now be specified:

      packages:
        "admissionregistration.k8s.io/v1: "admissionregistration.v1"

      build: gradle

	  dependencies:
	    "com.pulumi:aws": "5.4.0"

## 0.5.0 (2022-07-13)

### Improvements

- [provider] [#728](https://github.com/pulumi/pulumi-java/pull/728):
  Added health checks to `pulumi-language-java` so that it never
  leaks as an orphan process when the managing `pulumi` process
  terminates

- [codegen] [#717](https://github.com/pulumi/pulumi-java/issues/717):
  Simplified publishing generated provider code to Maven Central.

  Added a `gradleNexusPublishPluginVersion` option that installs
  [gradle-nexus/publish-plugin](https://github.com/gradle-nexus/publish-plugin)
  in the build code generated by `pulumi-java-gen`.

  The option can also be activated on the command line during code
  generation: `pulumi-java-gen --build gradle-nexus`.

  This enables one-step publishing of generated Java packages via
  Sonatype's OSSRH Nexus:

  ```
  gradle publishToSonatype closeAndReleaseSonatypeStagingRepository
  ```

### Bug Fixes

- [codegen] [#735](https://github.com/pulumi/pulumi-java/issues/735):
  Fix a bug introduced in `0.4.1`. `gradle publish` stopped generating
  resources required by Pulumi and published broken packages.

## 0.4.1 (2022-06-30)

### Improvements

- [sdk] #553: Added `com.pulumi.test` package with new idiomatic Java API for [unit testing Pulumi programs]
  (https://www.pulumi.com/docs/guides/testing/#unit-testing) against mocks.
  See ([example](https://github.com/pulumi/pulumi-java/tree/main/tests/examples/testing-unit-java)) of using the new API.

- [codegen] [#709](https://github.com/pulumi/pulumi-java/pull/709)
  Improved version handling in `pulumi-java-gen`: now `--version`
  argument is optional and the version of the generated package need
  not be known at SDK code generation time and is not spliced into the
  code. To set the version at build time use
  `gradle -Pversion=1.2.3 build` or `PACKAGE_VERSION=1.2.3 gradle build`.

## 0.4.0 (2022-06-22)

### Improvements

- [codegen] **Breaking**
  [#163](https://github.com/pulumi/pulumi-java/issues/163): function
  invokes now accept `Output<T>` in their arguments and return
  `Output<T>` instead of `CompletableFuture<T>`
  [#612](https://github.com/pulumi/pulumi-java/pull/612)

- [sdk] `Stack` resource is now considered internal and cannot be
  directly instantiated by the user. Instead of inheriting from
  `Stack`, please use the `Pulumi.run` form to define resources in
  your stack as shown in the README

- [sdk] [#478](https://github.com/pulumi/pulumi-java/issues/478):
  support stack transformations with new `Pulumi.withOptions` API

- [provider] [#576](https://github.com/pulumi/pulumi-java/issues/576)
  Added Gradle support for subprojects. For example, given this
  directory structure:

  ```
  proj/settings.gradle
  proj/subproj/build.gradle
  proj/subproj2/build.gradle
  ```

  Running `cd proj/subproj && pulumi up` will now locate the project
  root and run `gradle :subproj:run` from within `proj`. This makes sure
  Gradle features such as plugins work as expeceted.

## 0.3.0 (2022-06-01)

### Improvements

- [programgen] [#547](https://github.com/pulumi/pulumi-java/issues/547):
  Generate fully qualified imports

- [sdk] [#419](https://github.com/pulumi/pulumi-java/issues/419):
  Remove SDK dependency on Mockito

- [provider] Support for using [jbang](https://jbang.dev)

### Bug Fixes

- [codegen] [#627](https://github.com/pulumi/pulumi-java/issues/627):
  Fix malformed versions in generated build files by sanitizing
  version input in pulumi-java-gen

## 0.2.1 (2022-05-20)

### Improvements

- [provider] Add `pulumi-java-gen` binary encapsulating Java SDK
  generation to the GitHub releases.

## 0.2.0 (2022-05-18)

### Improvements

- [sdk]
  [#534](https://github.com/pulumi/pulumi-java/issues/534):
  `StackReferenceArgs` can now be instantiated using
  `StackReferenceArgs.builder()` and `StackReferenceArgs.Builder`,
  also `StackReferenceArgs.getName()` was deprecated in favour of
  `StackReferenceArgs.name()`
  [#537](https://github.com/pulumi/pulumi-java/pull/537)

- [sdk]
  [#430](https://github.com/pulumi/pulumi-java/issues/430):
  now you can pass both plain `Object` and
  `Output`-wrapped objects to `Output.format`, as in:
  `Output.format("Resource %s has ID %s", myResource, myResource.getId())`
  [#539](https://github.com/pulumi/pulumi-java/pull/539)

- [examples] Add examples from PulumiUp
  [#542](https://github.com/pulumi/pulumi-java/pull/542)

- [codegen] Make sure all overloads of function invokes have doc comments
  [#581](https://github.com/pulumi/pulumi-java/pull/581)

- [ci] GitHub Actions: use 'temurin' JDK instead of the deprecated
  'adopt' JDK

### Bug Fixes

- [programgen] Fix
  [#546](https://github.com/pulumi/pulumi-java/issues/546):
  generated Java programs from PCL now also generate custom resource options
  [#558](https://github.com/pulumi/pulumi-java/pull/558)

- [provider] Fix
  [#538](https://github.com/pulumi/pulumi-java/issues/538): provide
  detailed compilation failure information from `pulumi-language-java`
  in Pulumi CLI

- [sdk] Fix [#552](https://github.com/pulumi/pulumi-java/issues/552):
  `Output.all` will preserve list length and retain `null` elements

- [provider] Fix
  [#540](https://github.com/pulumi/pulumi-java/issues/540): language
  host will no longer fail when doing plugin discovery
